var fs = require('fs');
var error= require('./lib/error');
var insert = require('./lib/insert').init;
var select = require('./lib/select').init;
var update = require('./lib/update').init;


//errors
error.init({
    100: {
        message: 'Database does not exist',
        suggestions: 'Try runing the db.createDatabase, ' + 'db.databaseExists or db.listDatabases function'
    }
});


//db function
exports.db = function(db_name) {
    return new this.db.init(db_name);
};
exports.db.listDatabases = function(callback) {
    fs.readdir('node_modules/db/db_files', function(err, db_file_list) {
        var i = 0,
            db_item, db_list = [];

        for (; i < db_file_list.length; i++) {
            db_item = db_file_list[i].split('.');
            if (db_item[1] !== 'json') {
                continue;
            }
            else {
                db_list[db_list.length] = db_item[0];
            }
        }
        callback(db_list);
    });
};
exports.db.databaseExists = function(name, callback) {
    fs.readdir('node_modules/db/db_files', function(err, db_file_list) {
        var i = 0,
            db_item, db_list = [];

        for (; i < db_file_list.length; i++) {
            db_item = db_file_list[i].split('.');
            if (db_item[0] === name) {
                callback(true);
                return;
            }
        }
        callback(false);
    });
};
exports.db.init = function(db_name) {
    var db_file = fs.readFileSync('./db_files/' + db_name + '.json');
    if (!db_file) {
        error.logError(100);
        return false;
    }

};
debugger;